{% extends "base.html" %}

{% block title %}Preview: {{ file.original_filename }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h3>{{ file.original_filename }}</h3>
        <div class="btn-group">
            <a href="{{ url_for('files.download_file', file_id=file.id) }}" class="btn btn-primary">
                <i class="fas fa-download"></i> Download
            </a>
            <a href="{{ url_for('files.dashboard') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back
            </a>
        </div>
    </div>
    <div class="card-body">
        {% if file.file_type == 'image' %}
            <div class="text-center">
                <img src="{{ url_for('files.stream', file_id=file.id) }}" 
                     class="img-fluid" 
                     alt="{{ file.original_filename }}">
            </div>
        {% elif file.file_type == 'video' %}
            <div class="ratio ratio-16x9">
                <video controls>
                    <source src="{{ url_for('files.stream', file_id=file.id) }}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
        {% elif file.file_type == 'document' and file.mime_type == 'application/pdf' %}
            <div class="ratio ratio-1x1">
                <iframe src="{{ url_for('files.stream', file_id=file.id) }}" 
                        width="100%" 
                        height="100%" 
                        frameborder="0"></iframe>
            </div>
        {% else %}
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                Preview not available for this file type. Please download the file to view it.
            </div>
        {% endif %}

        <!-- File Information -->
        <div class="mt-4">
            <h4>File Information</h4>
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <th>Size</th>
                        <td>{{ (file.file_size / 1024 / 1024)|round(2) }} MB</td>
                    </tr>
                    <tr>
                        <th>Type</th>
                        <td>{{ file.file_type|title }}</td>
                    </tr>
                    <tr>
                        <th>Uploaded</th>
                        <td>{{ file.uploaded_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}